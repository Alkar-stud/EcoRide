<!-- Modale pour modifier un covoiturage -->
<div class="modal fade" id="modifierCovoiturageModal" tabindex="-1" aria-labelledby="modifierCovoiturageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header bg-warning text-white">
                <h5 class="modal-title" id="modifierCovoiturageModalLabel">
                    <i class="fas fa-edit me-2"></i>Modifier le covoiturage
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fermer"></button>
            </div>
            <div class="modal-body">
                <!-- Formulaire de modification de covoiturage -->
                <form id="modifierCovoiturageForm">
                    <div class="row">
                        <!-- Départ -->
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="modifierDepartAdresse" class="form-label">
                                    <i class="fas fa-map-marker-alt text-success me-1"></i>Adresse de départ *
                                </label>
                                <div class="position-relative">
                                    <input type="text" class="form-control" id="modifierDepartAdresse" name="modifierDepartAdresse" required 
                                           placeholder="Ex: 10 Rue de Rivoli, 75001 Paris"
                                           autocomplete="off">
                                    <div id="modifierDepartSuggestions" class="position-absolute w-100 bg-white border rounded shadow-sm" 
                                         style="display: none; z-index: 1000; max-height: 200px; overflow-y: auto; top: 100%;"></div>
                                </div>
                                <div class="form-text">Saisissez l'adresse complète du point de rendez-vous</div>
                                <!-- Champs cachés pour stocker les données parsées -->
                                <input type="hidden" id="modifierDepartStreet" name="modifierDepartStreet">
                                <input type="hidden" id="modifierDepartPostcode" name="modifierDepartPostcode">
                                <input type="hidden" id="modifierDepartCity" name="modifierDepartCity">
                            </div>
                        </div>

                        <!-- Arrivée -->
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="modifierArriveeAdresse" class="form-label">
                                    <i class="fas fa-flag-checkered text-danger me-1"></i>Adresse d'arrivée *
                                </label>
                                <div class="position-relative">
                                    <input type="text" class="form-control" id="modifierArriveeAdresse" name="modifierArriveeAdresse" required 
                                           placeholder="Ex: 25 Avenue des Champs-Élysées, 75008 Paris"
                                           autocomplete="off">
                                    <div id="modifierArriveeSuggestions" class="position-absolute w-100 bg-white border rounded shadow-sm" 
                                         style="display: none; z-index: 1000; max-height: 200px; overflow-y: auto; top: 100%;"></div>
                                </div>
                                <div class="form-text">Saisissez l'adresse complète du point d'arrivée</div>
                                <!-- Champs cachés pour stocker les données parsées -->
                                <input type="hidden" id="modifierArriveeStreet" name="modifierArriveeStreet">
                                <input type="hidden" id="modifierArriveePostcode" name="modifierArriveePostcode">
                                <input type="hidden" id="modifierArriveeCity" name="modifierArriveeCity">
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <!-- Date de départ -->
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="modifierDateDepart" class="form-label">
                                    <i class="fas fa-calendar text-primary me-1"></i>Date de départ *
                                </label>
                                <input type="date" class="form-control" id="modifierDateDepart" name="modifierDateDepart" required>
                            </div>
                        </div>

                        <!-- Heure de départ -->
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="modifierHeureDepart" class="form-label">
                                    <i class="fas fa-clock text-primary me-1"></i>Heure de départ *
                                </label>
                                <input type="time" class="form-control" id="modifierHeureDepart" name="modifierHeureDepart" required>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <!-- Véhicule -->
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="modifierVehicule" class="form-label">
                                    <i class="fas fa-car text-info me-1"></i>Véhicule *
                                </label>
                                <select class="form-select" id="modifierVehicule" name="modifierVehicule" required>
                                    <option value="">Sélectionnez votre véhicule</option>
                                    <!-- Les véhicules seront chargés dynamiquement -->
                                </select>
                            </div>
                        </div>

                        <!-- Nombre de places -->
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="modifierNbPlaces" class="form-label">
                                    <i class="fas fa-users text-info me-1"></i>Nombre de places disponibles *
                                </label>
                                <select class="form-select" id="modifierNbPlaces" name="modifierNbPlaces" required>
                                    <option value="">Sélectionnez le nombre de places</option>
                                    <option value="1">1 place</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <!-- Prix par place -->
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="modifierPrix" class="form-label">
                                    <i class="fas fa-euro-sign text-warning me-1"></i>Prix par place (en crédits) *
                                </label>
                                <input type="number" class="form-control" id="modifierPrix" name="modifierPrix" required 
                                       min="1" step="1" pattern="[0-9]+" placeholder="Ex: 15">
                                <div class="form-text">Le prix doit être équitable et couvrir les frais d'essence tout en prenant en compte la commission de EcoRide. Le prix moyen constaté est de 1 à 2 crédits par kilomètre</div>
                            </div>
                        </div>
                        
                        <!-- Colonne vide pour l'équilibrage -->
                        <div class="col-md-6"></div>
                    </div>

                    <!-- Préférences -->
                    <div class="mb-4">
                        <h6><i class="fas fa-cog me-2"></i>Préférences pour ce covoiturage</h6>
                        
                        <!-- Préférences prédéfinies (smokingAllowed et petsAllowed) -->
                        <div class="row" id="modifierPredefinedPreferences">
                            <!-- Ces cases seront cochées automatiquement selon les préférences utilisateur -->
                        </div>
                        
                        <!-- Préférences personnalisées existantes -->
                        <div id="modifierCustomPreferences" class="mt-3">
                            <!-- Les préférences personnalisées seront affichées ici -->
                        </div>
                        
                        <!-- Ajouter une nouvelle préférence -->
                        <div class="border p-3 mt-3 bg-light">
                            <h6><i class="fas fa-plus me-2"></i>Ajouter une préférence personnalisée</h6>
                            <div class="row">
                                <div class="col-md-4">
                                    <input type="text" class="form-control form-control-sm" id="modifierNewPrefTitle" 
                                           placeholder="Titre (obligatoire)" maxlength="50">
                                </div>
                                <div class="col-md-6">
                                    <input type="text" class="form-control form-control-sm" id="modifierNewPrefDescription" 
                                           placeholder="Description (facultatif)" maxlength="100">
                                </div>
                                <div class="col-md-2">
                                    <button type="button" class="btn btn-sm btn-success" id="modifierAddPreferenceBtn">
                                        <i class="fas fa-save me-1"></i>Sauvegarder
                                    </button>
                                </div>
                            </div>
                            <div class="form-text mt-2">
                                <i class="fas fa-info-circle me-1"></i>
                                La préférence sera sauvegardée dans votre compte et disponible pour tous vos futurs covoiturages.
                            </div>
                        </div>
                        
                        <!-- Liste des préférences ajoutées pour ce covoiturage -->
                        <div id="modifierAddedPreferences" class="mt-3">
                            <!-- Les nouvelles préférences ajoutées apparaîtront ici -->
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <!-- Bouton de suppression (visible si aucun passager) -->
                <button type="button" class="btn btn-danger me-auto" id="supprimerCovoiturageBtn" style="display: none;">
                    <i class="fas fa-trash me-2"></i>Supprimer
                </button>
                
                <!-- Bouton d'annulation (visible si des passagers) -->
                <button type="button" class="btn btn-danger me-auto" id="annulerCovoiturageBtn" style="display: none;">
                    <i class="fas fa-ban me-2"></i>Annuler le covoiturage
                </button>
                
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-1"></i>Fermer
                </button>
                <button type="button" class="btn btn-warning" id="modifierCovoiturageBtn">
                    <i class="fas fa-save me-1"></i>Enregistrer les modifications
                </button>
            </div>
        </div>
    </div>
</div>
